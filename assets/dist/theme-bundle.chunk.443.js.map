{"version":3,"file":"theme-bundle.chunk.443.js","mappings":"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","sources":["webpack://bigcommerce-cornerstone/./assets/js/theme/category.js","webpack://bigcommerce-cornerstone/./assets/js/theme/common/utils/translations-utils.js"],"sourcesContent":["import { hooks } from '@bigcommerce/stencil-utils';\nimport CatalogPage from './catalog';\nimport compareProducts from './global/compare-products';\nimport FacetedSearch from './common/faceted-search';\nimport { createTranslationDictionary } from '../theme/common/utils/translations-utils';\nimport { addAvailabilityToProductsCards } from './common/utils/product-availability';\n\nexport default class Category extends CatalogPage {\n    constructor(context) {\n        super(context);\n        this.validationDictionary = createTranslationDictionary(context);\n    }\n\n    setLiveRegionAttributes($element, roleType, ariaLiveStatus) {\n        $element.attr({\n            role: roleType,\n            'aria-live': ariaLiveStatus,\n        });\n    }\n\n    makeShopByPriceFilterAccessible() {\n        if (!$('[data-shop-by-price]').length) return;\n\n        if ($('.navList-action').hasClass('is-active')) {\n            $('a.navList-action.is-active').focus();\n        }\n\n        $('a.navList-action').on('click', () => this.setLiveRegionAttributes($('span.price-filter-message'), 'status', 'assertive'));\n    }\n\n    onReady() {\n        this.arrangeFocusOnSortBy();\n\n        this.handleAddToCart((e) =>\n            this.setLiveRegionAttributes($(e.currentTarget).next(), 'status', 'polite'));\n\n        this.makeShopByPriceFilterAccessible();\n\n        compareProducts(this.context);\n\n        if ($('#facetedSearch').length > 0) {\n            this.initFacetedSearch();\n        } else {\n            this.onSortBySubmit = this.onSortBySubmit.bind(this);\n            hooks.on('sortBy-submitted', this.onSortBySubmit);\n        }\n\n        $('a.reset-btn').on('click', () => this.setLiveRegionsAttributes($('span.reset-message'), 'status', 'polite'));\n\n        this.ariaNotifyNoProducts();\n\n        addAvailabilityToProductsCards('.productGrid', 'CATEGORY');\n        this.injectScentflirtProductLabels();\n    }\n\n    getProductIdFromHref(href) {\n        const regex = /product_id=(\\d+)/;\n        const match = href.match(regex);\n        if (match && match[1]) {\n            return match[1];\n        }\n        return null;\n    }\n\n    ariaNotifyNoProducts() {\n        const $noProductsMessage = $('[data-no-products-notification]');\n        if ($noProductsMessage.length) {\n            $noProductsMessage.focus();\n        }\n    }\n\n    initFacetedSearch() {\n        const {\n            price_min_evaluation: onMinPriceError,\n            price_max_evaluation: onMaxPriceError,\n            price_min_not_entered: minPriceNotEntered,\n            price_max_not_entered: maxPriceNotEntered,\n            price_invalid_value: onInvalidPrice,\n        } = this.validationDictionary;\n        const $productListingContainer = $('#product-listing-container');\n        const $facetedSearchContainer = $('#faceted-search-container');\n        const productsPerPage = this.context.categoryProductsPerPage;\n        const requestOptions = {\n            config: {\n                category: {\n                    shop_by_price: true,\n                    products: {\n                        limit: productsPerPage,\n                    },\n                },\n            },\n            template: {\n                productListing: 'category/product-listing',\n                sidebar: 'category/sidebar',\n            },\n            showMore: 'category/show-more',\n        };\n\n        this.facetedSearch = new FacetedSearch(this.context, requestOptions, (content) => {\n            $productListingContainer.html(content.productListing);\n            $facetedSearchContainer.html(content.sidebar);\n\n            $('body').triggerHandler('compareReset');\n\n            $('html, body').animate({\n                scrollTop: 0,\n            }, 100);\n        }, {\n            validationErrorMessages: {\n                onMinPriceError,\n                onMaxPriceError,\n                minPriceNotEntered,\n                maxPriceNotEntered,\n                onInvalidPrice,\n            },\n        });\n    }\n}\n","const TRANSLATIONS = 'translations';\nconst isTranslationDictionaryNotEmpty = (dictionary) => !!Object.keys(dictionary[TRANSLATIONS]).length;\nconst chooseActiveDictionary = (...dictionaryJsonList) => {\n    for (let i = 0; i < dictionaryJsonList.length; i++) {\n        const dictionary = JSON.parse(dictionaryJsonList[i]);\n        if (isTranslationDictionaryNotEmpty(dictionary)) {\n            return dictionary;\n        }\n    }\n};\n\n/**\n * defines Translation Dictionary to use\n * @param context provides access to 3 validation JSONs from en.json:\n * validation_messages, validation_fallback_messages and default_messages\n * @returns {Object}\n */\nexport const createTranslationDictionary = (context) => {\n    const { validationDictionaryJSON, validationFallbackDictionaryJSON, validationDefaultDictionaryJSON } = context;\n    const activeDictionary = chooseActiveDictionary(validationDictionaryJSON, validationFallbackDictionaryJSON, validationDefaultDictionaryJSON);\n    const localizations = Object.values(activeDictionary[TRANSLATIONS]);\n    const translationKeys = Object.keys(activeDictionary[TRANSLATIONS]).map(key => key.split('.').pop());\n\n    return translationKeys.reduce((acc, key, i) => {\n        acc[key] = localizations[i];\n        return acc;\n    }, {});\n};\n"],"names":["Category","_CatalogPage","context","_this","call","validationDictionary","createTranslationDictionary","_proto","prototype","setLiveRegionAttributes","$element","roleType","ariaLiveStatus","attr","role","makeShopByPriceFilterAccessible","_this2","$","length","hasClass","focus","on","onReady","_this3","this","arrangeFocusOnSortBy","handleAddToCart","e","currentTarget","next","compareProducts","initFacetedSearch","onSortBySubmit","bind","hooks","setLiveRegionsAttributes","ariaNotifyNoProducts","addAvailabilityToProductsCards","injectScentflirtProductLabels","getProductIdFromHref","href","match","$noProductsMessage","_this$validationDicti","onMinPriceError","price_min_evaluation","onMaxPriceError","price_max_evaluation","minPriceNotEntered","price_min_not_entered","maxPriceNotEntered","price_max_not_entered","onInvalidPrice","price_invalid_value","$productListingContainer","$facetedSearchContainer","requestOptions","config","category","shop_by_price","products","limit","categoryProductsPerPage","template","productListing","sidebar","showMore","facetedSearch","FacetedSearch","content","html","triggerHandler","animate","scrollTop","validationErrorMessages","CatalogPage","TRANSLATIONS","isTranslationDictionaryNotEmpty","dictionary","Object","keys","activeDictionary","i","arguments","JSON","parse","undefined","chooseActiveDictionary","validationDictionaryJSON","validationFallbackDictionaryJSON","validationDefaultDictionaryJSON","localizations","values","map","key","split","pop","reduce","acc"],"sourceRoot":""}